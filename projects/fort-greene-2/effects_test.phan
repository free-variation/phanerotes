# effects_test.phan
# Apply effects to pre-generated frames (one at a time)

# analyze audio (fast)
96 24 "projects/fort-greene-2/fort-greene-2.mp3" analyze-audio

# set up effects
3 2 0.5 0.005 0.3 set-camera-motion
0.5 8.0 2.0 set-chroma

# list frame files (sorted, last frame on top of string stack)
"projects/fort-greene-2/frames" list-files

: process-one
    0?
    sdup load
    dup wobble
    dup aberrate
    sdup s. cr
    "projects/fort-greene-2/frames-effects" save-in
    1 - process-one ;

process-one
drop

# finalize
1 2.0 5.0 "black" "white"
    "projects/fort-greene-2/frames-effects"
    "projects/fort-greene-2/fort-greene-2-effects-test.mp4"
    "projects/fort-greene-2/fort-greene-2.mp3"
    preview-video
